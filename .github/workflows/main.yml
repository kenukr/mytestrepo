name: Злые эксперименты

on: 
  push:
    branches:
       - main
         #schedule:
         # * is a special character in YAML so you have to quote this string
         #- cron:  '50 5,16 * * *'

env:
  ACTION_SLEEP_BEGIN: 0
  ACTION_SLEEP_END: 5

jobs:

  check_time:
    #if: github.head_ref == 'main'
    runs-on: ubuntu-latest
    steps:
      - name: Get Cuttent Time
        id: time
        uses: nanzm/get-time-action@v1.1
        with:
          timeZone: 2
          format: 'HH'

      - name: "Skip rest on sleep (non working) time (current hour is steps.time.outputs.time)"
        if: ${{ steps.time.outputs.time }} > ${{ env.ACTION_SLEEP_BEGIN }} && ${{ steps.time.outputs.time }} < ${{ env.ACTION_SLEEP_END }}
        run: |
          echo "Skip rest because current hour (${{ steps.time.outputs.time }}) is inside sleep period of time ( > ${{ env.ACTION_SLEEP_BEGIN }} and < ${{ env.ACTION_SLEEP_END }})"
          exit 2 
          
  greeting_job:
    runs-on: ubuntu-latest
    needs: [check_time]
    env:
      Greeting: Hello
    steps:
      - name: "Set time to var NOW_TIME"
        run: echo "NOW_TIME=`date +%H`" >> $GITHUB_ENV 

      - name: "Check dont Work Time for exit"
        if: ${{ (env.NOW_TIME > 1) && (env.NOW_TIME < 6) }}
        run: exit 1

      - name: "Greetingi you have WORK time"
        run: |
          echo "$Greeting ${{github.actor}}. Time is $NOW_TIME hour !"
